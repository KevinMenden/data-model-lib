<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TSVSampleBean.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">data-model-lib</a> &gt; <a href="index.source.html" class="el_package">life.qbic.datamodel.samples</a> &gt; <span class="el_source">TSVSampleBean.java</span></div><h1>TSVSampleBean.java</h1><pre class="source lang-java linenums">package life.qbic.datamodel.samples;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;

public class TSVSampleBean implements ISampleBean {

<span class="nc" id="L12">  private static final Logger logger = LogManager.getLogger(TSVSampleBean.class);</span>

  private String code;
  private String experiment;
  private String project;
  private String space;
  private SampleType sampleType;
  private String secondaryName;
  private List&lt;String&gt; parentIDs;
  private Map&lt;String, Object&gt; metadata;

  public TSVSampleBean(String code, String exp, String proj, String space, SampleType sType,
<span class="nc" id="L24">      String secondaryName, List&lt;String&gt; parentIDs, Map&lt;String, Object&gt; metadata) {</span>
<span class="nc" id="L25">    this.code = code;</span>
<span class="nc" id="L26">    this.experiment = exp;</span>
<span class="nc" id="L27">    this.project = proj;</span>
<span class="nc" id="L28">    this.space = space;</span>
<span class="nc" id="L29">    this.sampleType = sType;</span>
<span class="nc" id="L30">    this.secondaryName = secondaryName;</span>
<span class="nc" id="L31">    this.parentIDs = parentIDs;</span>
<span class="nc" id="L32">    this.metadata = metadata;</span>
<span class="nc" id="L33">  }</span>

  public TSVSampleBean(String prelimCode, SampleType sampleType, String secondaryName,
<span class="nc" id="L36">      Map&lt;String, Object&gt; metadata) {</span>
<span class="nc" id="L37">    this.code = prelimCode;</span>
<span class="nc" id="L38">    this.sampleType = sampleType;</span>
<span class="nc" id="L39">    this.secondaryName = secondaryName;</span>
<span class="nc" id="L40">    this.metadata = metadata;</span>
<span class="nc" id="L41">    this.parentIDs = new ArrayList&lt;String&gt;();</span>
<span class="nc" id="L42">  }</span>

  public String toString() {
<span class="nc" id="L45">    return code + &quot;\t&quot; + experiment + &quot;\t&quot; + secondaryName + &quot;\t&quot; + sampleType + &quot;\t&quot;</span>
<span class="nc" id="L46">        + getParentIDs() + &quot;\t&quot; + metadata;</span>
  }

  public boolean hasParents() {
<span class="nc bnc" id="L50" title="All 2 branches missed.">    return !parentIDs.isEmpty();</span>
  }

  public List&lt;String&gt; getParentIDs() {
<span class="nc" id="L54">    return parentIDs;</span>
    // if (!hasParents())
    // return new ArrayList&lt;String&gt;();
    // else {
    // if (parents.contains(&quot;,&quot;)) {
    // ArrayList&lt;String&gt; res = new ArrayList&lt;String&gt;();
    // for (String p : Arrays.asList(getParents().split(&quot;,&quot;))) {
    // res.add(p.trim());
    // }
    // return res;
    // } else
    // return new ArrayList&lt;String&gt;(Arrays.asList(getParents()));
    // }
  }

  @Override
  public boolean equals(Object o) {
<span class="nc bnc" id="L71" title="All 2 branches missed.">    if (o instanceof TSVSampleBean) {</span>
<span class="nc" id="L72">      TSVSampleBean b = (TSVSampleBean) o;</span>
<span class="nc" id="L73">      return code.equals(b.getCode());</span>
    } else
<span class="nc" id="L75">      return false;</span>
  }

  public String getCode() {
<span class="nc" id="L79">    return code;</span>
  }

  public void setCode(String id) {
<span class="nc" id="L83">    this.code = id;</span>
<span class="nc" id="L84">  }</span>

  public String getExperiment() {
<span class="nc" id="L87">    return experiment;</span>
  }

  public void setExperiment(String experiment) {
<span class="nc" id="L91">    this.experiment = experiment;</span>
<span class="nc" id="L92">  }</span>

  public String getProject() {
<span class="nc" id="L95">    return project;</span>
  }

  public void setProject(String project) {
<span class="nc" id="L99">    this.project = project;</span>
<span class="nc" id="L100">  }</span>

  public String getSpace() {
<span class="nc" id="L103">    return space;</span>
  }

  public void setSpace(String space) {
<span class="nc" id="L107">    this.space = space;</span>
<span class="nc" id="L108">  }</span>

  public SampleType getType() {
<span class="nc" id="L111">    return sampleType;</span>
  }

  public void setSampleType(SampleType sampleType) {
<span class="nc" id="L115">    this.sampleType = sampleType;</span>
<span class="nc" id="L116">  }</span>

  public String getSecondaryName() {
<span class="nc" id="L119">    return secondaryName;</span>
  }

  public void setSecondaryName(String secName) {
<span class="nc" id="L123">    this.secondaryName = secName;</span>
<span class="nc" id="L124">  }</span>

  public void setParents(List&lt;ISampleBean&gt; parents) {
<span class="nc" id="L127">    parentIDs = new ArrayList&lt;String&gt;();</span>
<span class="nc bnc" id="L128" title="All 2 branches missed.">    for (ISampleBean p : parents)</span>
<span class="nc" id="L129">      addParent(p);</span>
<span class="nc" id="L130">  }</span>

  public Map&lt;String, Object&gt; getMetadata() {
<span class="nc" id="L133">    return metadata;</span>
  }

  public void setMetadata(HashMap&lt;String, Object&gt; metadata) {
<span class="nc" id="L137">    this.metadata = metadata;</span>
<span class="nc" id="L138">  }</span>

  public void addParent(ISampleBean parent) {
<span class="nc" id="L141">    addParentID(parent.getCode());</span>
<span class="nc" id="L142">  }</span>

  public void addParentID(String id) {
<span class="nc bnc" id="L145" title="All 2 branches missed.">    if (!hasParents())</span>
<span class="nc" id="L146">      parentIDs = new ArrayList&lt;String&gt;();</span>
<span class="nc" id="L147">    parentIDs.add(id);</span>
<span class="nc" id="L148">  }</span>

  @Override
  public int hashCode() {
<span class="nc" id="L152">    return code.hashCode();</span>
  }

  public void addProperty(String key, Object val) {
<span class="nc" id="L156">    metadata.put(key, val);</span>
<span class="nc" id="L157">  }</span>

  @Override
  public ISampleBean copy() {
<span class="nc" id="L161">    TSVSampleBean res = new TSVSampleBean(code, experiment, project, space, sampleType,</span>
<span class="nc" id="L162">        secondaryName, parentIDs, copyMetadata(metadata));</span>
<span class="nc" id="L163">    return res;</span>
  }

  private Map&lt;String, Object&gt; copyMetadata(Map&lt;String, Object&gt; metadata) {
<span class="nc" id="L167">    Map&lt;String, Object&gt; res = new HashMap&lt;String, Object&gt;();</span>
<span class="nc bnc" id="L168" title="All 2 branches missed.">    for (String key : metadata.keySet())</span>
<span class="nc" id="L169">      res.put(key, metadata.get(key));</span>
<span class="nc" id="L170">    return res;</span>
  }

  @Override
  public List&lt;String&gt; getUnknownMetadataValuesForVocabulary(String propertyName,
      List&lt;String&gt; vocabulary) {
<span class="nc" id="L176">    List&lt;String&gt; res = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L177" title="All 2 branches missed.">    if (metadata.containsKey(propertyName)) {</span>
<span class="nc" id="L178">      Object prop = metadata.get(propertyName);</span>
<span class="nc bnc" id="L179" title="All 2 branches missed.">      if (prop instanceof List&lt;?&gt;) {</span>
<span class="nc bnc" id="L180" title="All 2 branches missed.">        for (String p : (List&lt;String&gt;) prop) {</span>
<span class="nc bnc" id="L181" title="All 2 branches missed.">          if (!vocabulary.contains(p)) {</span>
<span class="nc" id="L182">            res.add(p);</span>
          }
<span class="nc" id="L184">        }</span>
      }
<span class="nc bnc" id="L186" title="All 2 branches missed.">      if (prop instanceof String) {</span>
<span class="nc bnc" id="L187" title="All 2 branches missed.">        if (!vocabulary.contains(prop)) {</span>
<span class="nc" id="L188">          res.add((String) prop);</span>
        }
      }
<span class="nc" id="L191">    } else {</span>
<span class="nc" id="L192">      logger.info(&quot;Property type &quot; + propertyName + &quot; was not found for sample &quot; + code</span>
          + &quot; when trying to compare properties to vocabularies. Returning empty list.&quot;);
    }
<span class="nc" id="L195">    return res;</span>
  }

  @Override
  public void replaceMetadataValues(String propertyName, Map&lt;String, String&gt; oldToNewMetadata) {
<span class="nc bnc" id="L200" title="All 2 branches missed.">    if (metadata.containsKey(propertyName)) {</span>
<span class="nc" id="L201">      Object prop = metadata.get(propertyName);</span>
<span class="nc bnc" id="L202" title="All 2 branches missed.">      if (prop instanceof List&lt;?&gt;) {</span>
<span class="nc" id="L203">        List&lt;String&gt; res = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L204" title="All 2 branches missed.">        for (String p : (List&lt;String&gt;) prop) {</span>
<span class="nc bnc" id="L205" title="All 2 branches missed.">          if (oldToNewMetadata.containsKey(p)) {</span>
<span class="nc" id="L206">            res.add(oldToNewMetadata.get(p));</span>
          } else {
<span class="nc" id="L208">            res.add(p);</span>
          }
<span class="nc" id="L210">        }</span>
<span class="nc" id="L211">        metadata.put(propertyName, res);</span>
      }
<span class="nc bnc" id="L213" title="All 2 branches missed.">      if (prop instanceof String) {</span>
<span class="nc bnc" id="L214" title="All 2 branches missed.">        if (oldToNewMetadata.containsKey(prop)) {</span>
<span class="nc" id="L215">          metadata.put(propertyName, oldToNewMetadata.get(prop));</span>
        }
      }
    }
<span class="nc" id="L219">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.3.201901230119</span></div></body></html>